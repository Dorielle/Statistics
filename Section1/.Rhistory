seeds_data <- read.csv("seed_dataset.csv")
# Remove the last column
seeds = subset(seeds_data, select = -c(variety) )
pca = prcomp(seeds, scale=TRUE)
pca$sdev
head(pca$rotation)
head(pca$x)
install.packages("ggplot2")
library(ggplot2)
scores = as.data.frame(pca$x)
ggplot(data = scores, aes(x = PC1, y = PC2, label = rownames(scores))) +
geom_hline(yintercept = 0, colour = "gray65") +
geom_vline(xintercept = 0, colour = "gray65") +
geom_text(colour = "tomato", alpha = 0.8, size = 4) +
ggtitle("PCA plot of Seed")
circle <- function(center = c(0, 0), npoints = 100) {
r = 1
tt = seq(0, 2 * pi, length = npoints)
xx = center[1] + r * cos(tt)
yy = center[1] + r * sin(tt)
return(data.frame(x = xx, y = yy))
}
corcir = circle(c(0, 0), npoints = 100)
correlations = as.data.frame(cor(USArrests, pca1$x))
correlations = as.data.frame(cor(seeds, pca$x))
arrows = data.frame(x1 = c(0, 0, 0, 0), y1 = c(0, 0, 0, 0), x2 = correlations$PC1,
y2 = correlations$PC2)
arrows = data.frame(x1 = c(0, 0, 0, 0,0,0,0), y1 = c(0, 0, 0, 0,0,0,0), x2 = correlations$PC1,
y2 = correlations$PC2)
install.packages("factoextra")
library(factoextra)
fviz_eig(pca)
eig.val <- get_eigenvalue(pca)
eig.val
pca
pca
eig.val <- get_eigenvalue(pca)
eig.val
pca$sdev
pca
eig.val <- get_eigenvalue(pca)
eig.val
eig <- (pca$sdev)^2
eig
var <- eig*100/sum(eig)
var
cumVer <- cumsum(var)
cumVer
cumVar <- cumsum(var)
cumVar
eig.val <- get_eigenvalue(pca)
eig.val
eigVarCum <- data.frame(eig=eig, variance=var, cumvarience=cumVar)
head(eigVarCum)
eig.val
eig.val
head(eigVarCum)
colnames(pca) <- c("area","parameter","compactness","kernelLength","kernelWidth", "asymmetryCoefficient", "kernelGroveLength")
pcaClasses <- factor(pca$area)
pairs(pca[,-1], col = wineClasses, upper.panel = NULL, pch = 16, cex = 0.5)
pairs(pca[,], col = wineClasses, upper.panel = NULL, pch = 16, cex = 0.5)
pairs(pca[,1], col = wineClasses, upper.panel = NULL, pch = 16, cex = 0.5)
pairs(pca[,1], col = wineClasses, upper.panel = NULL, pch = 7, cex = 0.5)
pairs(pca[,-1], col = wineClasses, upper.panel = NULL, pch = 7, cex = 0.5)
pairs(pca[,-2], col = wineClasses, upper.panel = NULL, pch = 7, cex = 0.5)
pairs(pca[,-3], col = wineClasses, upper.panel = NULL, pch = 7, cex = 0.5)
pairs(pca[,-7], col = wineClasses, upper.panel = NULL, pch = 7, cex = 0.5)
summary(seeds)
summary(seeds_data)
eig.val
summary(pca)
plot(pca, type="l")
ggplot(data = scores, aes(x = PC1, y = PC2, label = rownames(scores))) +
geom_hline(yintercept = 0, colour = "gray65") +
geom_vline(xintercept = 0, colour = "gray65") +
geom_text(colour = "tomato", alpha = 0.8, size = 4) +
ggtitle("PCA plot of Seed")
rm(list=ls())
pca = prcomp(seeds, scale=TRUE)
summary(pca)
seeds_data <- read.csv("seed_dataset.csv")
summary(seeds_data)
pca = prcomp(seeds, -6, scale=TRUE)
summary(pca)
View(seeds_data)
pca = prcomp(seeds, -8, scale=TRUE)
summary(seeds_data)
pca = prcomp(seeds_data, -8, scale=TRUE)
summary(pca)
eig.val <- get_eigenvalue(pca)
eig.val
eig <- (pca$sdev)^2
eig
head(pca$rotation)
pca = prcomp(seeds_data, scale=TRUE)
summary(pca)
head(pca$rotation)
seeds_data <- read.csv("seed_dataset.csv")
summary(seeds_data)
# Remove the last column
seeds = subset(seeds_data, select = -c(variety) )
pca = prcomp(seeds, scale=TRUE)
summary(pca)
eig <- (pca$sdev)^2
eig
var <- eig*100/sum(eig)
var
cumVar <- cumsum(var)
cumVar
eigVarCum <- data.frame(eig=eig, variance=var, cumvarience=cumVar)
head(eigVarCum)
eig.val
eig.val <- get_eigenvalue(pca)
eig.val
eigVarCum
pca$sdev
eigVarCum <- data.frame(eigenValue=eig, variance=var, cumulativeVarience=cumVar)
eigVarCum
head(pca$rotation)
head(pca$x)
fviz_eig(pca)
plot(pca, type="l")
fviz_pca_ind(pca,
col.ind = "cos2", # Color by the quality of representation
gradient.cols = c("#00AFBB", "#E7B800", "#FC4E07"),
repel = TRUE     # Avoid text overlapping
)
fviz_pca_var(res.pca,
col.var = "contrib", # Color by contributions to the PC
gradient.cols = c("#00AFBB", "#E7B800", "#FC4E07"),
repel = TRUE     # Avoid text overlapping
)
fviz_pca_var(res.pca,
col.var = "contrib", # Color by contributions to the PC
gradient.cols = c("#00AFBB", "#E7B800", "#FC4E07"),
repel = TRUE     # Avoid text overlapping
)
fviz_pca_biplot(res.pca, repel = TRUE,
col.var = "#2E9FDF", # Variables color
col.ind = "#696969"  # Individuals color
)
fviz_pca_var(pca,
col.var = "contrib", # Color by contributions to the PC
gradient.cols = c("#00AFBB", "#E7B800", "#FC4E07"),
repel = TRUE     # Avoid text overlapping
)
fviz_pca_biplot(pca, repel = TRUE,
col.var = "#2E9FDF", # Variables color
col.ind = "#696969"  # Individuals color
)
res.var <- get_pca_var(pca)
res.var$coord          # Coordinates
res.var$contrib        # Contributions to the PCs
res.var$cos2
res.var$coord          # Coordinates
res.var$contrib        # Contributions to the PCs
res.var$cos2
res.ind <- get_pca_ind(pca)
res.ind$coord          # Coordinates
res.ind$contrib        # Contributions to the PCs
res.ind$cos2           # Quality of representation
rm(list=ls())
seeds_data <- read.csv("seed_dataset.csv")
summary(seeds_data)
# Remove the last column
seeds = subset(seeds_data, select = -c(variety) )
## PCA Functions ####
pca = prcomp(seeds, scale=TRUE)
summary(pca)
eig <- (pca$sdev)^2
eig
var <- eig*100/sum(eig)
var
cumVar <- cumsum(var)
cumVar
eigVarCum <- data.frame(eigenValue=eig, variance=var, cumulativeVarience=cumVar)
eigVarCum
head(pca$rotation)
head(pca$x)
scores = as.data.frame(pca$x)
ggplot(data = scores, aes(x = PC1, y = PC2, label = rownames(scores))) +
geom_hline(yintercept = 0, colour = "gray65") +
geom_vline(xintercept = 0, colour = "gray65") +
geom_text(colour = "tomato", alpha = 0.8, size = 4) +
ggtitle("PCA plot of Seed")
fviz_eig(pca)
fviz_pca_ind(pca,
col.ind = "cos2", # Color by the quality of representation
gradient.cols = c("#00AFBB", "#E7B800", "#FC4E07"),
repel = TRUE     # Avoid text overlapping
)
fviz_pca_var(pca,
col.var = "contrib", # Color by contributions to the PC
gradient.cols = c("#00AFBB", "#E7B800", "#FC4E07"),
repel = TRUE     # Avoid text overlapping
)
pca_var <- get_pca_var(pca)
pca_var$coord
pca_var$contrib
pca_var$cos2
summary(pca)
pca
eig
eig <- (pca$sdev)
eig
eig <- (pca$sdev)
eig
var <- eig*100/sum(eig)
var
cumVar <- cumsum(var)
cumVar
eigVarCum <- data.frame(eigenValue=eig, variance=var, cumulativeVarience=cumVar)
eigVarCum
eig <- (pca$sdev)^2
eig
var <- eig*100/sum(eig)
var
cumVar <- cumsum(var)
cumVar
eigVarCum <- data.frame(eigenValue=eig, variance=var, cumulativeVarience=cumVar)
eigVarCum
pca = prcomp(seeds, scale=TRUE)
summary(pca)
summary(pca)
fviz_eig(pca)
plot(pca, type="l")
plot(pca, type="l", title="Scree Plot")
plot(pca, type="l", name="Scree Plot")
plot(pca, type="l", main="Scree Plot")
fviz_eig(pca)
plot(pca, type="l", main="Scree Plot", col=blue)
plot(pca, type="l", main="Scree Plot")
pca = prcomp(seeds_data, -7, scale=TRUE)
summary(pca)
summary(pca)
eig <- (pca$sdev)^2
eig
pca = prcomp(seeds_data, -8, scale=TRUE)
summary(pca)
eig <- (pca$sdev)^2
eig
seeds = subset(seeds, select = -c(variety) )
## PCA Functions ####
pca = prcomp(seeds_data, scale=TRUE)
summary(pca)
summary(pca)
## PCA Functions ####
pca = prcomp(seeds, scale=TRUE)
summary(pca)
pca = prcomp(seeds[1:7], scale=TRUE)
summary(pca)
seeds <- read.csv("seed_dataset.csv")
summary(seeds)
# Remove the last column
# seeds = subset(seeds, select = -c(variety) )
## PCA Functions ####
pca = prcomp(seeds[1:7], scale=TRUE)
summary(pca)
pca = prcomp(seeds,-8, scale=TRUE)
summary(pca)
pca = prcomp(seeds[,-8], scale=TRUE)
summary(pca)
rm(list=ls())
seeds <- read.csv("seed_dataset.csv")
summary(seeds)
pca = prcomp(seeds[,-8], scale=TRUE)
summary(pca)
eig <- (pca$sdev)^2
eig
var <- eig*100/sum(eig)
var
cumVar <- cumsum(var)
cumVar
eigVarCum <- data.frame(eigenValue=eig, variance=var, cumulativeVarience=cumVar)
eigVarCum
# Loadings
head(pca$rotation)
# Principle Components (scores)
head(pca$x)
plot(pca, type="l", main="Scree Plot")
library(ggplot2)
library(factoextra)
seeds <- read.csv("seed_dataset.csv")
summary(seeds)
# PCA on the first 7 attributes
pca = prcomp(seeds[,-8], scale=TRUE)
summary(pca)
eig <- (pca$sdev)^2
eig
var <- eig*100/sum(eig)
var
cumVar <- cumsum(var)
cumVar
eigVarCum <- data.frame(eigenValue=eig, variance=var, cumulativeVarience=cumVar)
eigVarCum
head(pca$rotation)
head(pca$x)
plot(pca, type="l", main="Scree Plot")
groups <- as.factor(seeds$area[1:7])
fviz_pca_ind(pca,
col.ind = groups, # color by groups
palette = c("#00AFBB",  "#FC4E07"),
addEllipses = TRUE, # Concentration ellipses
ellipse.type = "confidence",
legend.title = "Groups",
repel = TRUE
)
summary(pca)
pca
pca
summary(pca)
eigVarCum
biplot(pca, scale=0)
eigVarCum
summary(pca)
pca
head(pca$x)
eigVarCum
eig
pca
head(pca$rotation)
summary(pca)
View(eigVarCum)
View(eigVarCum)
seeds2 <- cbind(seeds, pca[,1:2])
pca$x
seeds2 <- cbind(seeds, pca$x[,1:2])
seeds2
head(seeds2)
head(seeds2)
View(seeds2)
write.csv(file=seeds2, x=seeds2)
write.csv(file="seeds2.csv", x=seeds2)
fviz_eig(pca)
biplot(pca, scale=0)
